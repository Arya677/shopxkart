{% extends "base.html" %}
{% load static %}
{% block main-content %}

<section class="section-content padding-y bg">
  <div class="container">

    <h4 class="text-center mb-4">‚úÖ Your Cash on Delivery Order is Confirmed!</h4>
    <p class="text-center text-muted">Thank you for shopping with us. Here's your order summary:</p>

    <div class="row">
      <!-- Billing Address -->
      <aside class="col-lg-8 mx-auto mt-4">

        <!-- Billing Address Card -->
        <div class="card shadow-sm mb-4">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Billing Address</h5>
          </div>
          <div class="card-body">
            <ul class="list-group list-group-flush">
              <li class="list-group-item"><strong>Name:</strong> {{ order.full_name }}</li>
              <li class="list-group-item"><strong>Address:</strong> {{ order.full_address }}</li>
              <li class="list-group-item"><strong>City/State:</strong> {{ order.city }}, {{ order.state }}</li>
              <li class="list-group-item"><strong>Email:</strong> {{ order.email }}</li>
              <li class="list-group-item"><strong>Phone:</strong> +91 {{ order.phone }}</li>
              {% if order.order_note %}
              <li class="list-group-item"><strong>Order Note:</strong> {{ order.order_note }}</li>
              {% endif %}
            </ul>
          </div>
        </div>

        <!-- Review Products -->
        <div class="card shadow-sm mb-4">
          <div class="card-header bg-secondary text-white">
            <h5 class="mb-0">Ordered Products</h5>
          </div>
          <div class="card-body table-responsive">
            <table class="table align-middle">
              <thead class="table-light">
                <tr>
                  <th>Product</th>
                  <th class="text-center">Qty</th>
                  <th class="text-end">Price</th>
                </tr>
              </thead>
              <tbody>
                {% for cart_item in cart_items %}
                <tr>
                  <td>
                    <div class="d-flex align-items-center">
                      <img src="{{ cart_item.product.images.url }}" alt="{{ cart_item.product.product_name }}" class="img-thumbnail me-2" style="width: 60px;">
                      <div>
                        <strong>{{ cart_item.product.product_name }}</strong><br>
                        <small class="text-muted">
                          {% for item in cart_item.variations.all %}
                          {{ item.variation_category|capfirst }}: {{ item.variation_value|capfirst }}<br>
                          {% endfor %}
                        </small>
                      </div>
                    </div>
                  </td>
                  <td class="text-center">{{ cart_item.quantity }}</td>
                  <td class="text-end">${{ cart_item.sub_total|floatformat:2 }}</td>
                </tr>
                {% endfor %}
              </tbody>
              <tfoot>
                <tr>
                  <td colspan="2" class="text-end"><strong>Total:</strong></td>
                  <td class="text-end text-success"><strong>${{ total|floatformat:2 }}</strong></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>

        <!-- Order Totals -->
        <div class="card shadow-sm">
          <div class="card-header bg-success text-white">
            <h5 class="mb-0">Order Summary</h5>
          </div>
          <div class="card-body">
            <ul class="list-group list-group-flush">
              <li class="list-group-item d-flex justify-content-between">
                <span>Total Price:</span>
                <strong>${{ total|floatformat:2 }}</strong>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Tax:</span>
                <strong>${{ tax|floatformat:2 }}</strong>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Grand Total:</span>
                <strong class="text-success">${{ grand_total|floatformat:2 }}</strong>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Payment Method:</span>
                <strong>Cash on Delivery</strong>
              </li>
            </ul>
          </div>
        </div>

        <!-- Continue Shopping Button -->
        <div class="text-center mt-4">
          <a href="{% url 'store' %}" class="btn btn-outline-primary">
            üõç Continue Shopping
          </a>
        </div>

      </aside>
    </div>

  </div>
</section>

{% endblock %}
